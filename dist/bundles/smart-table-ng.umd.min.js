!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/core"),require("smart-table-core"),require("rxjs/index"),require("rxjs/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define("smart-table-ng",["exports","@angular/core","smart-table-core","rxjs/index","rxjs/operators","@angular/common"],factory):factory(global["smart-table-ng"]={},global.ng.core,global["smart-table-core"],global.rxjs.index,global.rxjs.operators,global.ng.common)}(this,function(exports,core,smartTableCore,index,operators,common){"use strict";
/**
     * @license smart-table-ng
     * MIT license
     */var SmartTable=function(){function SmartTable(){}return SmartTable.decorators=[{type:core.Injectable}],SmartTable}(),StSortDirective=function(){function StSortDirective(table$$1,_el){this.table=table$$1,this._el=_el,this.currentSortDirection="none",this.delay=0,this.cycle=!1}return Object.defineProperty(StSortDirective.prototype,"isAsc",{get:function(){return"asc"===this.currentSortDirection},enumerable:!0,configurable:!0}),Object.defineProperty(StSortDirective.prototype,"isDesc",{get:function(){return"desc"===this.currentSortDirection},enumerable:!0,configurable:!0}),StSortDirective.prototype.toggle=function(){this._directive.toggle()},StSortDirective.prototype.ngOnInit=function(){var _this=this;this._directive=smartTableCore.sort({table:this.table,pointer:this.pointer,cycle:!0===this.cycle||"true"===this.cycle,debounceTime:this.delay}),this._directive.onSortToggle(function(_a){var direction=_a.direction,pointer=_a.pointer;_this.currentSortDirection=pointer===_this.pointer?direction:"none"});var initState=this._directive.state();this.currentSortDirection=initState.pointer===this.pointer?initState.direction||"asc":"none"},StSortDirective.prototype.ngOnDestroy=function(){this._directive.off()},StSortDirective.decorators=[{type:core.Directive,args:[{selector:"[stSort]",exportAs:"stSort"}]}],StSortDirective.ctorParameters=function(){return[{type:SmartTable},{type:core.ElementRef}]},StSortDirective.propDecorators={delay:[{type:core.Input,args:["stDebounceTime"]}],pointer:[{type:core.Input,args:["stSort"]}],cycle:[{type:core.Input,args:["stSortCycle"]}],isAsc:[{type:core.HostBinding,args:["class.st-sort-asc"]}],isDesc:[{type:core.HostBinding,args:["class.st-sort-desc"]}],toggle:[{type:core.HostListener,args:["click"]}]},StSortDirective}(),StFilterDirective=function(){function StFilterDirective(table$$1,_el){this.table=table$$1,this._el=_el,this.operator="includes",this.type="string",this.delay=300}return StFilterDirective.prototype.filter=function(value){return this._directive.filter(value)},StFilterDirective.prototype.ngOnInit=function(){var _this=this;this._directive=smartTableCore.filter({pointer:this.pointer,table:this.table,operator:this.operator,type:this.type});var event="SELECT"===this._el.nativeElement.tagName?"change":"input";this._inputSubscription=index.fromEvent(this._el.nativeElement,event).pipe(operators.map(function($event){return $event.target.value}),operators.debounceTime(this.delay),operators.distinctUntilChanged()).subscribe(function(v){return _this.filter(v)});var state=this._directive.state();Array.isArray(state[this.pointer])&&(this._el.nativeElement.value=state[this.pointer][0].value)},StFilterDirective.prototype.ngOnDestroy=function(){this._directive.off(),this._inputSubscription.unsubscribe()},StFilterDirective.decorators=[{type:core.Directive,args:[{selector:"[stFilter]",exportAs:"stFilter"}]}],StFilterDirective.ctorParameters=function(){return[{type:SmartTable},{type:core.ElementRef}]},StFilterDirective.propDecorators={pointer:[{type:core.Input,args:["stFilter"]}],operator:[{type:core.Input,args:["stFilterOperator"]}],type:[{type:core.Input,args:["stFilterType"]}],delay:[{type:core.Input,args:["stDebounceTime"]}]},StFilterDirective}(),StSearchDirective=function(){function StSearchDirective(table$$1,_el){this.table=table$$1,this._el=_el,this.delay=300,this.flags="i",this.escape=!1}return StSearchDirective.prototype.search=function(value){return this._directive.search(value,{flags:this.flags,escape:"true"===this.escape||!0===this.escape})},StSearchDirective.prototype.ngOnInit=function(){var _this=this,scope=Array.isArray(this.scope)?this.scope:this.scope.split(",").map(function(p){return p.trim()});this._directive=smartTableCore.search({scope:scope,table:this.table});var value=this._directive.state().value;this._el.nativeElement.value=value||"",this._inputSubscription=index.fromEvent(this._el.nativeElement,"input").pipe(operators.map(function($event){return $event.target.value}),operators.debounceTime(this.delay),operators.distinctUntilChanged()).subscribe(function(v){return _this.search(v)})},StSearchDirective.prototype.ngOnDestroy=function(){this._directive.off(),this._inputSubscription.unsubscribe()},StSearchDirective.decorators=[{type:core.Directive,args:[{selector:"[stSearch]",exportAs:"stSearch"}]}],StSearchDirective.ctorParameters=function(){return[{type:SmartTable},{type:core.ElementRef}]},StSearchDirective.propDecorators={scope:[{type:core.Input,args:["stSearch"]}],delay:[{type:core.Input,args:["stDebounceTime"]}],flags:[{type:core.Input,args:["stSearchFlags"]}],escape:[{type:core.Input,args:["stSearchEscape"]}]},StSearchDirective}(),StPaginationDirective=function(){function StPaginationDirective(table$$1){this.table=table$$1,this.page=1,this.size=20}return StPaginationDirective.prototype.ngOnInit=function(){var _this=this;this._directive=smartTableCore.slice({table:this.table}),this._directive.onSummaryChange(function(_a){var page=_a.page,size=_a.size,filteredCount=_a.filteredCount;_this.page=page,_this.size=size,_this.length=filteredCount})},StPaginationDirective.prototype.ngOnDestroy=function(){this._directive.off()},Object.defineProperty(StPaginationDirective.prototype,"lowerBoundIndex",{get:function(){return(this.page-1)*this.size},enumerable:!0,configurable:!0}),Object.defineProperty(StPaginationDirective.prototype,"higherBoundIndex",{get:function(){return Math.min(this.page*this.size-1,this.length-1)},enumerable:!0,configurable:!0}),StPaginationDirective.prototype.selectPage=function(p){return this._directive.selectPage(+p)},StPaginationDirective.prototype.selectNextPage=function(){return this._directive.selectNextPage()},StPaginationDirective.prototype.selectPreviousPage=function(){return this._directive.selectPreviousPage()},StPaginationDirective.prototype.changePageSize=function(size){return this._directive.changePageSize(+size)},StPaginationDirective.prototype.isPreviousPageEnabled=function(){return this._directive.isPreviousPageEnabled()},StPaginationDirective.prototype.isNextPageEnabled=function(){return this._directive.isNextPageEnabled()},StPaginationDirective.decorators=[{type:core.Directive,args:[{selector:"[stPagination]",exportAs:"stPagination"}]}],StPaginationDirective.ctorParameters=function(){return[{type:SmartTable}]},StPaginationDirective}();var StTableDirective=function(){function StTableDirective(table$$1){this.table=table$$1,this.items=[],this.busy=!1,this.display=new core.EventEmitter,this.sort=new core.EventEmitter,this.filter=new core.EventEmitter,this.slice=new core.EventEmitter,this.exec=new core.EventEmitter}return StTableDirective.prototype.ngOnInit=function(){this.displayHandler=function(items){this.items=items,this.display.emit(items)}.bind(this),this.sortHandler=function(state){this.sort.emit(state)}.bind(this),this.filterHandler=function(state){this.filter.emit(state)}.bind(this),this.sliceHandler=function(state){this.slice.emit(state)}.bind(this),this.execHandler=function(state){this.busy=state.working,this.exec.emit(state)}.bind(this),this.table.onDisplayChange(this.displayHandler),this.table.on("TOGGLE_SORT",this.sortHandler),this.table.on("FILTER_CHANGED",this.filterHandler),this.table.on("CHANGE_PAGE",this.sliceHandler),this.table.on("EXEC_CHANGED",this.execHandler),this.table.init()},StTableDirective.prototype.ngOnDestroy=function(){this.table.off("DISPLAY_CHANGED",this.displayHandler),this.table.off("TOGGLE_SORT",this.sortHandler),this.table.off("FILTER_CHANGED",this.filterHandler),this.table.off("CHANGE_PAGE",this.sliceHandler),this.table.off("EXEC_CHANGED",this.execHandler)},StTableDirective.decorators=[{type:core.Directive,args:[{selector:"[stTable]",exportAs:"stTable"}]}],StTableDirective.ctorParameters=function(){return[{type:SmartTable}]},StTableDirective.propDecorators={display:[{type:core.Output}],sort:[{type:core.Output}],filter:[{type:core.Output}],slice:[{type:core.Output}],exec:[{type:core.Output}]},StTableDirective}(),TableState=function(){function TableState(){this.filter={},this.search={},this.slice={page:1,size:20},this.sort={}}return TableState.decorators=[{type:core.Injectable}],TableState}(),SmartTableModule=function(){function SmartTableModule(){}return SmartTableModule.forRoot=function(){return{ngModule:SmartTableModule,providers:[TableState]}},SmartTableModule.decorators=[{type:core.NgModule,args:[{declarations:[StSortDirective,StFilterDirective,StSearchDirective,StPaginationDirective,StTableDirective],imports:[common.CommonModule],exports:[StPaginationDirective,StSortDirective,StFilterDirective,StSearchDirective,StTableDirective],providers:[]}]}],SmartTableModule}(),from$1=function(data,tableState){void 0===tableState&&(tableState=new TableState);for(var extensions=[],_i=2;_i<arguments.length;_i++)extensions[_i-2]=arguments[_i];var subscription,dataArray=[],table$$1=smartTableCore.table.apply(void 0,[{data:dataArray,tableState:tableState}].concat(extensions)),source=index.from(data);return Object.assign(table$$1,{init:function(){subscription&&subscription.unsubscribe(),table$$1.dispatch("EXEC_CHANGED",{working:!0}),subscription=source.subscribe(function(items){dataArray.splice.apply(dataArray,[0,dataArray.length].concat(items)),table$$1.exec()})},use:function(newData){subscription.unsubscribe(),source=index.of(newData),table$$1.dispatch("EXEC_CHANGED",{working:!0}),subscription=source.subscribe(function(values){dataArray.splice.apply(dataArray,[0,dataArray.length].concat(values)),table$$1.exec()})},ngOnDestroy:function(){subscription.unsubscribe()}})};exports.SmartTableModule=SmartTableModule,exports.SmartTable=SmartTable,exports.StFilterDirective=StFilterDirective,exports.StPaginationDirective=StPaginationDirective,exports.StSearchDirective=StSearchDirective,exports.StSortDirective=StSortDirective,exports.StTableDirective=StTableDirective,exports.TableState=TableState,exports.from=from$1,exports.of=function(data,tableState){void 0===tableState&&(tableState=new TableState);for(var extensions=[],_i=2;_i<arguments.length;_i++)extensions[_i-2]=arguments[_i];return from$1.apply(void 0,[index.of(data),tableState].concat(extensions))},Object.defineProperty(exports,"__esModule",{value:!0})});