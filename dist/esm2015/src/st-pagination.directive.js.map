{"version":3,"file":"st-pagination.directive.js","sourceRoot":"","sources":["../package/src/st-pagination.directive.ts"],"names":[],"mappings":"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","sourcesContent":["import {Directive, OnInit, OnDestroy} from '@angular/core';\nimport {SmartTable} from './smart-table.service';\nimport {paginationDirective as slice} from 'smart-table-core';\n\ninterface SummaryOutput {\n    page: number;\n    size: number;\n    filteredCount: number;\n}\n\n@Directive({\n    selector: '[stPagination]',\n    exportAs: 'stPagination'\n})\nexport class StPaginationDirective<T> implements OnInit, OnDestroy {\n    private _directive: any;\n\n    page = 1;\n    size = 20;\n    length: number;\n\n    constructor(private table: SmartTable<T>) {\n    }\n\n    ngOnInit() {\n        this._directive = slice({table: this.table});\n        this._directive.onSummaryChange(({page, size, filteredCount}: SummaryOutput) => {\n            let goToOne = false;\n            this.page = page;\n            // Il faut retourner sur la première page au besoin\n            if ((this.size !== size || this.length !== filteredCount) && this.page > 1) {\n                goToOne = true;\n            }\n            this.size = size;\n            this.length = filteredCount;\n            if (goToOne) {\n                this.selectPage(1);\n            }\n        });\n    }\n\n    ngOnDestroy() {\n        this._directive.off();\n    }\n\n    get lowerBoundIndex(): number {\n        return (this.page - 1) * this.size;\n    }\n\n    get higherBoundIndex(): number {\n        return Math.min(this.page * this.size - 1, this.length - 1);\n    }\n\n    get pageCount(): number {\n        return this.size ? Math.ceil(this.length / this.size) : 1;\n    }\n\n    get pages(): number[] {\n        return Array.from({ length: this.pageCount }, (v, k) => k + 1);\n    }\n\n    selectPage(p: number): void {\n        return this._directive.selectPage(+(p));\n    }\n\n    selectNextPage(): void {\n        return this._directive.selectNextPage();\n    }\n\n    selectPreviousPage(): void {\n        return this._directive.selectPreviousPage();\n    }\n\n    changePageSize(size: number): void {\n        // Force number cast;\n        return this._directive.changePageSize(+(size));\n    }\n\n    isPreviousPageEnabled(): boolean {\n        return this._directive.isPreviousPageEnabled();\n    }\n\n    isNextPageEnabled(): boolean {\n        return this._directive.isNextPageEnabled();\n    }\n}\n"]}